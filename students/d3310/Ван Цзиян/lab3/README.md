# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 3 - Docker –∏ Celery –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

## –û–±–∑–æ—Ä

–î–∞–Ω–Ω–∞—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker, Docker Compose –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Celery —Å Redis –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á –ø–∞—Ä—Å–∏–Ω–≥–∞ URL.

## –ó–∞–¥–∞—á–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã

### üê≥ –ó–∞–¥–∞—á–∞ 1: –°–æ–∑–¥–∞–Ω–∏–µ Dockerfile
- –°–æ–∑–¥–∞–Ω–∏–µ Dockerfile –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø–∞—Ä—Å–µ—Ä–∞
- –£–∫–∞–∑–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### üêô –ó–∞–¥–∞—á–∞ 2: –°–æ–∑–¥–∞–Ω–∏–µ Docker Compose —Ñ–∞–π–ª–∞
- –ù–∞–ø–∏—Å–∞–Ω–∏–µ docker-compose.yml –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ FastAPI, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–∞—Ä—Å–µ—Ä–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

### üåê –ó–∞–¥–∞—á–∞ 3: –°–æ–∑–¥–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ FastAPI –¥–ª—è –≤—ã–∑–æ–≤–∞ –ø–∞—Ä—Å–µ—Ä–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–∞—Ä—Å–∏–Ω–≥ URL
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–∞—Ä—Å–µ—Ä—É –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–µ–Ω—Ç—É

### ‚ö° –ó–∞–¥–∞—á–∞ 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Celery –∏ Redis —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Celery –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redis –∫–∞–∫ –±—Ä–æ–∫–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ–Ω–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á –ø–∞—Ä—Å–∏–Ω–≥–∞

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **FastAPI** - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è API
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- **Docker Compose** - –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –º–Ω–æ–≥–æ–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- **Celery** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á
- **Redis** - –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
- **PostgreSQL** - —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker –∏ Docker Compose
- Python 3.11+
- Git

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**
```bash
git clone <repository-url>
cd lab3
```

2. **–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤**
```bash
docker compose up -d
```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–æ–≤**
```bash
docker compose ps
```

4. **–î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é**
- –û—Å–Ω–æ–≤–Ω–æ–µ API: http://localhost:8000
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API: http://localhost:8000/docs
- –ü–∞—Ä—Å–µ—Ä API: http://localhost:8001
- Redis: localhost:6379

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

```
docs/
‚îú‚îÄ‚îÄ index.md                    # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îú‚îÄ‚îÄ dockerfile/                 # –ó–∞–¥–∞—á–∞ 1 - Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ creation.md            # –°–æ–∑–¥–∞–Ω–∏–µ Dockerfile
‚îú‚îÄ‚îÄ docker-compose/            # –ó–∞–¥–∞—á–∞ 2 - Docker Compose
‚îÇ   ‚îî‚îÄ‚îÄ creation.md           # –°–æ–∑–¥–∞–Ω–∏–µ docker-compose.yml
‚îú‚îÄ‚îÄ fastapi/                   # –ó–∞–¥–∞—á–∞ 3 - FastAPI –∏ –ø–∞—Ä—Å–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ endpoints.md          # –°–æ–∑–¥–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ celery/                    # –ó–∞–¥–∞—á–∞ 4 - Celery
‚îÇ   ‚îî‚îÄ‚îÄ setup.md              # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Celery
‚îî‚îÄ‚îÄ redis/                     # –ó–∞–¥–∞—á–∞ 4 - Redis
    ‚îî‚îÄ‚îÄ setup.md              # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Redis
```

## –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥
```http
POST /api/v1/parser/parse-urls
Content-Type: application/json

{
  "urls": ["https://example.com", "https://httpbin.org/html"],
  "mode": "asyncio"
}
```

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —á–µ—Ä–µ–∑ Celery
```http
POST /api/v1/async-parser/parse-urls-async
Content-Type: application/json

{
  "urls": ["https://example.com", "https://httpbin.org/html"],
  "mode": "asyncio"
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏
```http
GET /api/v1/async-parser/task-status/{task_id}
```

## –ó–∞–ø—É—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MkDocs
```bash
pip install -r requirements-mkdocs.txt
```

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
mkdocs serve
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫
```bash
chmod +x start_mkdocs.sh
./start_mkdocs.sh
```

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# –õ–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose logs -f

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker compose logs -f celery-worker
docker compose logs -f redis
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Redis
docker compose exec redis redis-cli ping

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Celery –≤–æ—Ä–∫–µ—Ä–æ–≤
docker compose exec celery-worker celery -A app.celery_app inspect active
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```mermaid
graph TB
    Client[–ö–ª–∏–µ–Ω—Ç] --> FastAPI[FastAPI API]
    FastAPI --> Parser[–ü–∞—Ä—Å–µ—Ä]
    FastAPI --> Celery[Celery Queue]
    Celery --> Redis[(Redis)]
    Celery --> Worker[Celery Worker]
    Worker --> Parser
    FastAPI --> DB[(PostgreSQL)]
    
    subgraph "Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã"
        FastAPI
        Parser
        Celery
        Worker
        Redis
        DB
    end
```

## –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. **–ö–ª–∏–µ–Ω—Ç** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å –≤ FastAPI
2. **FastAPI** —Å–æ–∑–¥–∞–µ—Ç Celery –∑–∞–¥–∞—á—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ—ë –≤ Redis
3. **Redis** —Ö—Ä–∞–Ω–∏—Ç –∑–∞–¥–∞—á—É –≤ –æ—á–µ—Ä–µ–¥–∏
4. **Celery Worker** –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á—É –∏–∑ Redis –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –µ—ë
5. **–†–µ–∑—É–ª—å—Ç–∞—Ç** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ Redis
6. **–ö–ª–∏–µ–Ω—Ç** –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ task_id

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. üìñ –ò–∑—É—á–∏—Ç–µ [—Å–æ–∑–¥–∞–Ω–∏–µ Dockerfile](docs/dockerfile/creation.md)
2. üîß –ù–∞—Å—Ç—Ä–æ–π—Ç–µ [Docker Compose](docs/docker-compose/creation.md)
3. üåê –°–æ–∑–¥–∞–π—Ç–µ [—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã FastAPI](docs/fastapi/endpoints.md)
4. ‚ö° –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ [Celery –∏ Redis](docs/celery/setup.md)

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MkDocs –∏ Material for MkDocs*